#!/usr/bin/env ruby
require 'fileutils'
REFINERY_ROOT = File.expand_path(File.dirname(__FILE__) << "/..")
RAILS_ROOT = ARGV.first unless defined? RAILS_ROOT
unless RAILS_ROOT.nil? or RAILS_ROOT.length == 0
  # ensure asset directories exist.
  dirs = [%w(public stylesheets), %w(public javascripts)]
  dirs.each do |dir|
    FileUtils::makedirs File.join(RAILS_ROOT, dir)
  end
  
  # copy in the new assets
  assets = [%w(public stylesheets refinery), %w(public javascripts refinery)]
	assets.each do |asset|
	  FileUtils::rm_rf File.join(RAILS_ROOT, asset), :secure => true # ensure the destination is clear.
	  FileUtils::cp_r File.join(REFINERY_ROOT, asset), File.join(RAILS_ROOT, asset) # copy the new assets into the project.
  end
	
	puts "---------"
	puts "Copied new Refinery core assets."
else
  puts "Please specify the path of the refinery project that you want to update, i.e. refinery-update-core /path/to/project"
end